package android.app.main

import android.app.obj.ObjReader
import android.app.pathtracer.*
import android.app.rendering.AsyncTaskDoneListener
import android.app.rendering.RenderAsyncTask
import android.os.AsyncTask
import android.os.Bundle
import android.util.Log
import com.google.android.material.snackbar.Snackbar
import androidx.appcompat.app.AppCompatActivity
import android.view.Menu
import android.view.MenuItem
import com.example.pathtrace.R

import kotlinx.android.synthetic.main.activity_main.*
import kotlinx.android.synthetic.main.content_main.*

class MainActivity : AppCompatActivity(), AsyncTaskDoneListener {

    private var passes = 1
    private var finishedThreadsCounter = 0
    private val threads = 8
    private val completeArray = mutableListOf<RenderFragment>()
    private val objTest = "v -0.026151 0.603170 0.663330\n" +
            "v -0.661018 0.603170 0.061193\n" +
            "v -0.213556 0.444710 0.452220\n" +
            "v -0.440294 0.444710 0.237172\n" +
            "v -0.092112 0.751306 0.494468\n" +
            "v -0.488904 0.751306 0.118132\n" +
            "v 0.271075 0.701613 0.508886\n" +
            "v -0.522509 0.701613 -0.243784\n" +
            "v -0.088950 0.703217 0.604662\n" +
            "v -0.599112 0.703217 0.120802\n" +
            "v -0.217664 0.797137 0.229496\n" +
            "v -0.293174 0.784225 0.309111\n" +
            "v -0.558560 0.232665 0.588922\n" +
            "v -0.064866 0.801017 0.068393\n" +
            "v 0.678476 0.366329 -0.715357\n" +
            "v 0.026661 -0.518305 -0.028111\n" +
            "v -0.236395 0.201368 0.544418\n" +
            "v -0.531155 0.201368 0.264855\n" +
            "v -0.349443 -0.192374 0.879315\n" +
            "v -0.859604 -0.192374 0.395455\n" +
            "v -0.447728 -0.417644 0.948884\n" +
            "v 0.151323 0.303354 0.760029\n" +
            "v -0.766968 0.303354 -0.110919\n" +
            "v 0.242274 0.898157 0.459783\n" +
            "v -0.471952 0.898157 -0.217621\n" +
            "v -0.192927 0.713547 0.385060\n" +
            "v -0.374318 0.713547 0.213021\n" +
            "v -0.101033 0.447935 0.651460\n" +
            "v -0.645206 0.447935 0.135343\n" +
            "v 0.183183 0.548954 0.715084\n" +
            "v -0.723771 0.548954 -0.145110\n" +
            "v 0.241157 0.634803 0.676664\n" +
            "v -0.688471 0.634803 -0.205035\n" +
            "v -0.723120 -0.145906 0.762428\n" +
            "v -0.623775 -0.109114 0.816621\n" +
            "v -0.782491 -0.109114 0.666087\n" +
            "v -0.655415 -0.215616 0.861335\n" +
            "v -0.825469 -0.215616 0.700048\n" +
            "v -0.751101 -0.273063 0.791930\n" +
            "v -0.488381 0.311415 0.514929\n" +
            "v -0.460843 0.349498 0.485894\n" +
            "v -0.390484 0.343366 0.559297\n" +
            "v -0.537864 0.343366 0.419515\n" +
            "v -0.461783 0.232990 0.611766\n" +
            "v -0.586489 0.232990 0.493489\n" +
            "v -0.093798 0.379516 0.677890\n" +
            "v -0.671981 0.379516 0.129516\n" +
            "v 0.133543 0.430187 0.756070\n" +
            "v -0.762074 0.430187 -0.093373\n" +
            "v 0.288854 0.532174 0.751255\n" +
            "v -0.765480 0.532174 -0.248721\n" +
            "v 0.282938 0.775192 0.700729\n" +
            "v -0.714711 0.775192 -0.245485\n" +
            "v 0.048380 1.020792 0.403103\n" +
            "v -0.405097 1.020792 -0.026995\n" +
            "v -0.198831 0.860067 0.357226\n" +
            "v -0.346211 0.860067 0.217444\n" +
            "v -0.391469 0.423726 0.594394\n" +
            "v -0.572860 0.423726 0.422355\n" +
            "v -0.515733 -0.232397 0.929763\n" +
            "v -0.901188 -0.232397 0.564180\n" +
            "v -0.619181 -0.337609 0.891248\n" +
            "v -0.857256 -0.337609 0.665447\n" +
            "v -0.372454 0.486986 0.392700\n" +
            "v -0.323597 0.639962 0.341188\n" +
            "v -0.226101 0.575092 0.476801\n" +
            "v -0.464176 0.575092 0.250999\n" +
            "v -0.604781 -0.084585 0.807948\n" +
            "v -0.774835 -0.084585 0.646662\n" +
            "v -0.594980 0.115189 0.627322\n" +
            "v -0.430661 0.315931 0.647069\n" +
            "v -0.623389 0.315931 0.464277\n" +
            "v -0.446937 0.385966 0.527996\n" +
            "v -0.503622 0.385966 0.474234\n" +
            "v -0.533910 0.353691 0.562933\n" +
            "v -0.245795 0.098414 0.633799\n" +
            "v -0.619914 0.098414 0.278969\n" +
            "v -0.368232 0.250419 0.626657\n" +
            "v -0.606307 0.250419 0.400856\n" +
            "v -0.707097 -0.254667 0.813650\n" +
            "v -0.775118 -0.254667 0.749136\n" +
            "v -0.640885 -0.132350 0.811957\n" +
            "v -0.776928 -0.132350 0.682928\n" +
            "v -0.687585 -0.206578 0.724961\n" +
            "v -0.624449 -0.240787 0.794626\n" +
            "v -0.760492 -0.240787 0.665597\n" +
            "v -0.204000 0.655776 0.464851\n" +
            "v -0.453412 0.655776 0.228297\n" +
            "v 0.017640 0.806819 0.469572\n" +
            "v -0.469847 0.806819 0.007217\n" +
            "v 0.182472 0.706772 0.625011\n" +
            "v -0.633786 0.706772 -0.149164\n" +
            "v 0.135624 0.574450 0.697111\n" +
            "v -0.703308 0.574450 -0.098569\n" +
            "v 0.000860 0.525069 0.691614\n" +
            "v -0.690692 0.525069 0.035716\n" +
            "v -0.210957 0.569928 0.551656\n" +
            "v -0.539728 0.569928 0.239836\n" +
            "v -0.109033 0.778417 0.421486\n" +
            "v -0.415130 0.778417 0.131170\n" +
            "v -0.141023 0.702574 0.432509\n" +
            "v -0.424446 0.702574 0.163698\n" +
            "v -0.083712 0.517646 0.633197\n" +
            "v -0.627884 0.517646 0.117080\n" +
            "v 0.123832 0.581873 0.664133\n" +
            "v -0.669752 0.581873 -0.088538\n" +
            "v 0.159482 0.637061 0.637898\n" +
            "v -0.645440 0.637061 -0.125525\n" +
            "v 0.061889 0.771318 0.536446\n" +
            "v -0.538968 0.771318 -0.033433\n" +
            "v -0.039584 0.787131 0.450436\n" +
            "v -0.447713 0.787131 0.063349\n" +
            "v -0.184434 0.599621 0.489632\n" +
            "v -0.479194 0.599621 0.210069\n" +
            "v -0.053244 0.739372 0.215078\n" +
            "v -0.211961 0.739372 0.064544\n" +
            "v 0.216186 0.907520 0.260233\n" +
            "v -0.271301 0.907520 -0.202122\n" +
            "v 0.288355 0.779071 0.399844\n" +
            "v -0.414534 0.779071 -0.266807\n" +
            "v 0.420519 0.660628 0.544316\n" +
            "v -0.565793 0.660628 -0.391146\n" +
            "v 0.428583 0.361131 0.672048\n" +
            "v -0.693772 0.361131 -0.392443\n" +
            "v 0.024271 0.216863 0.610167\n" +
            "v -0.610596 0.216863 0.008030\n" +
            "v 0.226957 0.884294 -0.239295\n" +
            "v 0.785429 0.222369 0.420685\n" +
            "v -0.461632 0.222369 -0.762083\n" +
            "v 0.910748 -0.062595 0.163673\n" +
            "v -0.211608 -0.062595 -0.900818\n" +
            "v 0.474870 0.006775 0.566481\n" +
            "v -0.590801 0.006775 -0.444248\n" +
            "v 0.466119 -0.199769 0.371356\n" +
            "v -0.395487 -0.199769 -0.445829\n" +
            "v 0.693571 -0.272375 0.199657\n" +
            "v -0.236056 -0.272375 -0.682042\n" +
            "v -0.199280 -0.024221 0.550697\n" +
            "v -0.539388 -0.024221 0.228124\n" +
            "v -0.333269 -0.200434 0.533030\n" +
            "v -0.514660 -0.200434 0.360991\n" +
            "v -0.758424 -0.470893 0.561242\n" +
            "v -0.193296 0.045490 0.521682\n" +
            "v -0.510730 0.045490 0.220614\n" +
            "v -0.196745 0.112618 0.513965\n" +
            "v -0.502842 0.112618 0.223650\n" +
            "v -0.102128 -0.204945 0.414206\n" +
            "v -0.408225 -0.204945 0.123890\n" +
            "v 0.325542 0.677090 0.326578\n" +
            "v -0.343337 0.677090 -0.307816\n" +
            "v 0.735085 0.585769 0.155887\n" +
            "v -0.194543 0.585769 -0.725812\n" +
            "v 0.904646 0.411819 0.204165\n" +
            "v -0.251720 0.411819 -0.892583\n" +
            "v 0.995158 0.257563 -0.118323\n" +
            "v 0.065531 0.257563 -1.000023\n" +
            "v 0.656824 -0.320459 0.011346\n" +
            "v -0.046065 -0.320459 -0.655305\n" +
            "v 0.844814 0.131685 0.301308\n" +
            "v -0.345563 0.131685 -0.827698\n" +
            "v 0.141297 -0.042930 0.441368\n" +
            "v -0.448223 -0.042930 -0.117758\n" +
            "v 0.342419 -0.284002 0.263371\n" +
            "v -0.281111 -0.284002 -0.328012\n" +
            "v 0.568733 -0.187829 0.524280\n" +
            "v -0.553623 -0.187829 -0.540211\n" +
            "v 1.185035 -0.223319 0.612409\n" +
            "v -0.674220 -0.223319 -1.150991\n" +
            "v 1.340015 0.137180 0.380887\n" +
            "v -0.451219 0.137180 -1.317997\n" +
            "v 1.114565 0.180423 0.312067\n" +
            "v -0.370572 0.180423 -1.096502\n" +
            "v 1.259144 0.101355 0.398037\n" +
            "v -0.464068 0.101355 -1.236333\n" +
            "v 1.260975 -0.024836 0.509635\n" +
            "v -0.575606 -0.024836 -1.232260\n" +
            "v 0.940269 0.146532 0.348251\n" +
            "v -0.397488 0.146532 -0.920536\n" +
            "v 0.744477 -0.149097 0.497922\n" +
            "v -0.536595 -0.149097 -0.717104\n" +
            "v 1.142109 -0.202340 0.521434\n" +
            "v -0.581103 -0.202340 -1.112936\n" +
            "v 1.239814 0.010990 0.395713\n" +
            "v -0.460724 0.010990 -1.217152\n" +
            "v 0.737508 -0.095843 0.323624\n" +
            "v -0.362173 -0.095843 -0.719362\n" +
            "v 0.766549 -0.157164 0.417886\n" +
            "v -0.457838 -0.157164 -0.743377\n" +
            "v 0.565145 -0.043567 0.459946\n" +
            "v -0.489189 -0.043567 -0.540031\n" +
            "v 0.604340 -0.124893 0.407267\n" +
            "v -0.438656 -0.124893 -0.581957\n" +
            "v 0.639430 -0.085519 0.370270\n" +
            "v -0.403567 -0.085519 -0.618954\n" +
            "v 0.778729 0.028732 0.336926\n" +
            "v -0.377637 0.028732 -0.759822\n" +
            "v 1.000478 0.013891 0.330179\n" +
            "v -0.382626 0.013891 -0.981617\n" +
            "v 0.888316 -0.159098 0.425733\n" +
            "v -0.472114 -0.159098 -0.864559\n" +
            "v 1.402213 0.029067 0.338014\n" +
            "v -0.411695 0.029067 -1.382375\n" +
            "v 0.993530 0.063271 0.201271\n" +
            "v -0.253531 0.063271 -0.981496\n" +
            "f 4/1/1 6/2/1 10/3/1 2/4/1\n" +
            "f 7/5/2 1/6/2 3/7/2 5/8/2\n" +
            "f 4/1/3 2/4/3 8/9/3 6/2/3\n" +
            "f 157/10/4 163/11/4 16/12/4\n" +
            "f 35/13/5 60/14/5 68/15/5\n" +
            "f 32/16/6 50/17/6 52/18/6\n" +
            "f 38/19/7 61/20/7 63/21/7\n" +
            "f 111/22/8 89/23/8 99/24/8\n" +
            "f 59/25/9 47/26/9 18/27/9\n" +
            "f 49/28/10 51/29/10 23/30/10\n" +
            "f 23/30/11 51/29/11 124/31/11\n" +
            "f 54/32/12 24/33/12 117/34/12\n" +
            "f 7/5/13 5/8/13 9/35/13 1/6/13\n" +
            "f 20/36/14 61/20/14 69/37/14\n" +
            "f 69/37/15 36/38/15 34/39/15\n" +
            "f 63/21/16 142/40/16 62/41/16\n" +
            "f 156/42/17 15/43/17 158/44/17\n" +
            "f 75/45/18 72/46/18 13/47/18\n" +
            "f 138/48/19 76/49/19 19/50/19\n" +
            "f 198/51/20 200/52/20 186/53/20 196/54/20\n" +
            "f 51/29/21 49/28/21 31/55/21\n" +
            "f 58/56/22 46/57/22 28/58/22\n" +
            "f 142/40/23 140/59/23 21/60/23 62/41/23\n" +
            "f 68/15/24 60/14/24 19/50/24\n" +
            "f 139/61/25 20/36/25 77/62/25\n" +
            "f 35/13/26 34/39/26 82/63/26\n" +
            "f 34/39/15 35/13/15 68/15/15\n" +
            "f 12/64/27 11/65/27 57/66/27\n" +
            "f 72/46/28 45/67/28 13/47/28\n" +
            "f 70/68/29 44/69/29 13/47/29 45/67/29\n" +
            "f 41/70/30 40/71/30 73/72/30\n" +
            "f 58/56/31 17/73/31 46/57/31\n" +
            "f 38/19/32 36/38/32 61/20/32\n" +
            "f 24/33/33 52/18/33 121/74/33\n" +
            "f 101/75/34 99/24/34 26/76/34 87/77/34\n" +
            "f 48/78/35 22/79/35 50/17/35\n" +
            "f 47/26/36 59/25/36 29/80/36\n" +
            "f 51/29/37 31/55/37 33/81/37\n" +
            "f 48/78/38 50/17/38 30/82/38\n" +
            "f 27/83/39 57/66/39 100/84/39\n" +
            "f 196/54/40 178/85/40 198/51/40\n" +
            "f 156/42/41 152/86/41 127/87/41 15/88/41\n" +
            "f 197/89/42 177/90/42 195/91/42\n" +
            "f 182/92/43 180/93/43 200/52/43\n" +
            "f 185/94/44 187/95/44 199/96/44\n" +
            "f 138/48/45 140/59/45 147/97/45\n" +
            "f 44/69/46 68/15/46 19/50/46 76/49/46\n" +
            "f 45/67/47 77/62/47 20/36/47 69/37/47\n" +
            "f 46/57/48 17/73/48 125/98/48 22/79/48\n" +
            "f 18/27/49 47/26/49 23/30/49 126/99/49\n" +
            "f 16/12/50 148/100/50 164/101/50\n" +
            "f 132/102/51 123/103/51 22/79/51 125/98/51\n" +
            "f 121/74/52 52/18/52 50/17/52 123/103/52\n" +
            "f 124/31/53 51/29/53 53/104/53 122/105/53\n" +
            "f 23/30/54 124/31/54 133/106/54 126/99/54\n" +
            "f 124/31/55 122/105/55 152/86/55 129/107/55\n" +
            "f 51/29/56 33/81/56 53/104/56\n" +
            "f 90/108/57 112/109/57 100/84/57\n" +
            "f 57/66/58 11/65/58 116/110/58\n" +
            "f 24/33/59 119/111/59 117/34/59\n" +
            "f 115/112/60 56/113/60 54/32/60 117/34/60\n" +
            "f 109/114/61 91/115/61 89/23/61\n" +
            "f 120/116/62 25/117/62 118/118/62\n" +
            "f 52/18/63 24/33/63 54/32/63\n" +
            "f 78/119/64 44/69/64 76/49/64\n" +
            "f 116/120/65 118/118/65 55/121/65 57/66/65\n" +
            "f 56/113/66 12/64/66 26/76/66\n" +
            "f 89/23/67 54/32/67 56/113/67 99/24/67\n" +
            "f 90/108/68 100/84/68 57/66/68 55/121/68\n" +
            "f 71/122/69 42/123/69 73/72/69\n" +
            "f 25/117/70 53/104/70 55/121/70\n" +
            "f 54/32/71 89/23/71 91/115/71 52/18/71\n" +
            "f 90/108/72 55/121/72 53/104/72 92/124/72\n" +
            "f 148/100/73 16/125/73 147/97/73\n" +
            "f 48/78/74 30/82/74 95/126/74 28/58/74\n" +
            "f 31/55/75 49/28/75 29/80/75 96/127/75\n" +
            "f 94/128/76 31/55/76 96/127/76\n" +
            "f 53/104/77 33/81/77 92/124/77\n" +
            "f 58/56/78 28/58/78 97/129/78 66/130/78\n" +
            "f 29/80/79 59/25/79 67/131/79 98/132/79\n" +
            "f 29/80/80 98/132/80 104/133/80 96/127/80\n" +
            "f 30/82/81 93/134/81 95/126/81\n" +
            "f 32/16/82 52/18/82 91/115/82\n" +
            "f 66/130/83 87/77/83 26/76/83 65/135/83\n" +
            "f 88/136/84 67/131/84 65/135/84 27/83/84\n" +
            "f 100/84/85 102/137/85 88/136/85 27/83/85\n" +
            "f 77/62/86 79/138/86 18/27/86 146/139/86\n" +
            "f 80/140/87 39/141/87 62/41/87 37/142/87\n" +
            "f 63/21/88 39/141/88 81/143/88 38/19/88\n" +
            "f 83/144/89 86/145/89 84/146/89\n" +
            "f 58/56/90 42/123/90 78/119/90\n" +
            "f 35/13/91 37/142/91 60/14/91\n" +
            "f 69/37/92 34/39/92 68/15/92 70/68/92\n" +
            "f 191/147/93 179/148/93 187/95/93\n" +
            "f 41/70/94 74/149/94 40/71/94\n" +
            "f 71/122/95 44/69/95 78/119/95 42/123/95\n" +
            "f 45/67/96 72/46/96 43/150/96 79/138/96\n" +
            "f 75/45/97 71/122/97 73/72/97\n" +
            "f 30/82/98 50/17/98 32/16/98\n" +
            "f 71/122/99 75/45/99 13/47/99\n" +
            "f 73/72/100 40/71/100 74/149/100 75/45/100\n" +
            "f 34/39/101 36/38/101 83/144/101\n" +
            "f 17/73/102 58/56/102 78/119/102\n" +
            "f 78/119/103 76/49/103 145/151/103 17/73/103\n" +
            "f 147/97/104 16/125/104 163/11/104\n" +
            "f 86/145/105 81/143/105 84/146/105\n" +
            "f 72/46/106 75/45/106 74/149/106\n" +
            "f 74/149/107 41/70/107 43/150/107\n" +
            "f 41/70/108 42/123/108 58/56/108 64/152/108\n" +
            "f 59/25/109 43/150/109 41/70/109 64/152/109\n" +
            "f 44/69/110 71/122/110 13/47/110\n" +
            "f 59/25/111 79/138/111 43/150/111\n" +
            "f 41/70/112 73/72/112 42/123/112\n" +
            "f 105/153/113 103/154/113 95/126/113\n" +
            "f 82/63/114 34/39/114 83/144/114 84/146/114\n" +
            "f 119/155/115 115/156/115 117/157/115\n" +
            "f 85/158/116 80/140/116 37/142/116 82/63/116\n" +
            "f 81/143/117 86/145/117 83/144/117 38/19/117\n" +
            "f 111/22/118 109/114/118 89/23/118\n" +
            "f 69/37/119 70/68/119 45/67/119\n" +
            "f 43/150/120 72/46/120 74/149/120\n" +
            "f 83/144/121 36/38/121 38/19/121\n" +
            "f 81/143/122 80/140/122 84/146/122\n" +
            "f 81/143/15 39/141/15 80/140/15\n" +
            "f 61/20/123 36/38/123 69/37/123\n" +
            "f 160/159/124 178/85/124 196/54/124\n" +
            "f 85/158/125 82/63/125 84/146/125\n" +
            "f 67/131/126 64/152/126 65/135/126\n" +
            "f 161/160/127 147/97/127 163/11/127\n" +
            "f 65/135/128 12/64/128 27/83/128\n" +
            "f 12/64/129 57/66/129 27/83/129\n" +
            "f 103/154/130 97/129/130 28/58/130 95/126/130\n" +
            "f 64/152/131 67/131/131 59/25/131\n" +
            "f 28/58/132 46/57/132 48/78/132\n" +
            "f 95/126/133 93/134/133 105/153/133\n" +
            "f 49/28/134 47/26/134 29/80/134\n" +
            "f 106/161/135 108/162/135 94/128/135\n" +
            "f 107/163/136 93/134/136 32/16/136 91/115/136\n" +
            "f 33/81/137 94/128/137 108/162/137 92/124/137\n" +
            "f 67/131/15 88/136/15 114/164/15 98/132/15\n" +
            "f 85/158/138 84/146/138 80/140/138\n" +
            "f 33/81/139 31/55/139 94/128/139\n" +
            "f 64/152/140 66/130/140 65/135/140\n" +
            "f 26/76/141 12/64/141 65/135/141\n" +
            "f 113/165/15 87/77/15 66/130/15 97/129/15\n" +
            "f 66/130/142 64/152/142 58/56/142\n" +
            "f 92/124/143 108/162/143 110/166/143\n" +
            "f 30/82/144 32/16/144 93/134/144\n" +
            "f 105/153/145 93/134/145 107/163/145\n" +
            "f 96/127/146 104/133/146 106/161/146\n" +
            "f 98/132/147 114/164/147 104/133/147\n" +
            "f 106/161/148 94/128/148 96/127/148\n" +
            "f 109/114/149 107/163/149 91/115/149\n" +
            "f 102/137/150 114/164/150 88/136/150\n" +
            "f 90/108/151 110/166/151 112/109/151\n" +
            "f 112/109/152 102/137/152 100/84/152\n" +
            "f 99/24/153 101/75/153 111/22/153\n" +
            "f 103/154/154 113/165/154 97/129/154\n" +
            "f 14/167/155 116/110/155 11/65/155 115/156/155\n" +
            "f 201/168/156 167/169/156 165/170/156 203/171/156\n" +
            "f 87/77/157 113/165/157 101/75/157\n" +
            "f 70/68/158 68/15/158 44/69/158\n" +
            "f 11/65/159 12/64/159 56/113/159\n" +
            "f 190/172/160 133/106/160 129/107/160\n" +
            "f 26/76/161 99/24/161 56/113/161\n" +
            "f 25/117/162 55/121/162 118/118/162\n" +
            "f 120/116/163 122/173/163 25/117/163\n" +
            "f 11/65/164 56/113/164 115/112/164\n" +
            "f 92/124/165 110/166/165 90/108/165\n" +
            "f 119/111/166 24/33/166 121/74/166\n" +
            "f 49/28/167 23/30/167 47/26/167\n" +
            "f 53/104/168 25/117/168 122/173/168\n" +
            "f 141/174/169 139/61/169 148/100/169\n" +
            "f 151/175/170 149/176/170 121/177/170\n" +
            "f 121/74/171 123/103/171 128/178/171 151/175/171\n" +
            "f 155/179/172 130/180/172 157/10/172\n" +
            "f 50/17/173 22/79/173 123/103/173\n" +
            "f 191/147/174 165/170/174 179/148/174\n" +
            "f 22/79/175 48/78/175 46/57/175\n" +
            "f 131/181/176 156/42/176 158/44/176\n" +
            "f 39/141/177 63/21/177 62/41/177\n" +
            "f 142/40/178 61/20/178 20/36/178 141/174/178\n" +
            "f 62/41/179 21/60/179 60/14/179 37/142/179\n" +
            "f 76/49/180 143/182/180 145/151/180\n" +
            "f 139/61/181 141/174/181 20/36/181\n" +
            "f 79/138/182 59/25/182 18/27/182\n" +
            "f 144/183/183 139/61/183 77/62/183\n" +
            "f 45/67/184 79/138/184 77/62/184\n" +
            "f 146/139/185 144/183/185 77/62/185\n" +
            "f 37/142/186 35/13/186 82/63/186\n" +
            "f 140/59/187 138/48/187 19/50/187\n" +
            "f 167/169/188 175/184/188 181/185/188\n" +
            "f 19/50/189 21/60/189 140/59/189\n" +
            "f 141/174/190 148/100/190 147/97/190 140/59/190\n" +
            "f 132/102/191 189/186/191 128/178/191\n" +
            "f 202/187/192 204/188/192 166/189/192 168/190/192\n" +
            "f 188/191/193 200/52/193 180/93/193\n" +
            "f 151/175/194 153/192/194 155/179/194\n" +
            "f 132/102/195 128/178/195 123/103/195\n" +
            "f 158/44/196 15/43/196 157/10/196 16/12/196\n" +
            "f 155/179/197 15/88/197 127/87/197 151/175/197\n" +
            "f 60/14/198 21/60/198 19/50/198\n" +
            "f 156/42/199 154/193/199 152/86/199\n" +
            "f 138/48/200 143/182/200 76/49/200\n" +
            "f 125/98/201 161/160/201 132/102/201\n" +
            "f 153/192/202 151/175/202 128/178/202\n" +
            "f 160/194/203 154/193/203 131/181/203\n" +
            "f 197/89/204 183/195/204 173/196/204 177/90/204\n" +
            "f 159/197/205 130/180/205 153/192/205\n" +
            "f 142/40/206 63/21/206 61/20/206\n" +
            "f 141/174/207 140/59/207 142/40/207\n" +
            "f 134/198/208 136/199/208 165/170/208\n" +
            "f 154/193/209 160/194/209 129/107/209\n" +
            "f 154/193/210 129/107/210 152/86/210\n" +
            "f 119/155/211 121/177/211 149/176/211\n" +
            "f 169/200/212 173/196/212 175/184/212\n" +
            "f 122/105/213 120/201/213 150/202/213\n" +
            "f 128/178/214 159/197/214 153/192/214\n" +
            "f 150/202/215 14/167/215 127/203/215\n" +
            "f 120/201/216 118/204/216 116/120/216\n" +
            "f 115/156/217 119/155/217 149/176/217 14/205/217\n" +
            "f 150/202/218 120/201/218 116/120/218 14/167/218\n" +
            "f 14/205/219 149/176/219 127/87/219\n" +
            "f 150/202/220 152/86/220 122/105/220\n" +
            "f 162/206/221 126/99/221 133/106/221\n" +
            "f 143/182/222 138/48/222 147/97/222\n" +
            "f 129/107/223 133/106/223 124/31/223\n" +
            "f 156/42/224 131/181/224 154/193/224\n" +
            "f 130/180/225 136/207/225 157/10/225\n" +
            "f 162/206/226 164/101/226 148/100/226\n" +
            "f 130/180/227 155/179/227 153/192/227\n" +
            "f 132/102/228 161/160/228 163/11/228 134/208/228\n" +
            "f 164/101/229 162/206/229 133/106/229 135/209/229\n" +
            "f 150/202/230 127/203/230 152/86/230\n" +
            "f 125/98/231 145/151/231 143/182/231 161/160/231\n" +
            "f 144/183/232 146/139/232 126/99/232 162/206/232\n" +
            "f 143/182/233 147/97/233 161/160/233\n" +
            "f 162/206/234 148/100/234 144/183/234\n" +
            "f 18/27/235 126/99/235 146/139/235\n" +
            "f 127/87/236 149/176/236 151/175/236\n" +
            "f 158/44/237 137/210/237 131/181/237\n" +
            "f 130/180/238 159/197/238 203/211/238\n" +
            "f 145/151/239 125/98/239 17/73/239\n" +
            "f 134/208/240 163/11/240 157/10/240 136/207/240\n" +
            "f 158/44/241 164/101/241 135/209/241 137/210/241\n" +
            "f 144/183/242 148/100/242 139/61/242\n" +
            "f 177/90/243 171/212/243 203/211/243 159/213/243\n" +
            "f 204/188/244 172/214/244 178/85/244 160/215/244\n" +
            "f 165/170/245 136/199/245 203/171/245\n" +
            "f 203/171/246 171/212/246 201/168/246\n" +
            "f 169/200/247 171/216/247 173/196/247\n" +
            "f 165/170/248 167/169/248 181/185/248 179/148/248\n" +
            "f 182/92/249 168/190/249 166/189/249 180/93/249\n" +
            "f 172/217/250 204/188/250 202/187/250\n" +
            "f 168/190/251 176/218/251 170/219/251\n" +
            "f 166/189/252 135/220/252 192/221/252\n" +
            "f 184/222/253 174/223/253 176/218/253\n" +
            "f 134/198/254 165/170/254 191/147/254\n" +
            "f 180/93/255 192/221/255 188/191/255\n" +
            "f 195/91/256 185/94/256 199/96/256 197/89/256\n" +
            "f 174/223/257 184/222/257 198/51/257 178/85/257\n" +
            "f 176/218/258 182/92/258 184/222/258\n" +
            "f 132/102/259 134/208/259 191/224/259 189/186/259\n" +
            "f 192/225/260 135/209/260 133/106/260 190/172/260\n" +
            "f 202/187/261 168/190/261 170/219/261\n" +
            "f 188/191/262 194/226/262 186/53/262\n" +
            "f 187/95/263 193/227/263 191/147/263\n" +
            "f 181/185/264 175/184/264 183/195/264\n" +
            "f 196/54/265 129/107/265 160/194/265\n" +
            "f 200/52/266 198/51/266 182/92/266\n" +
            "f 195/91/267 193/227/267 185/94/267\n" +
            "f 128/178/268 189/186/268 193/228/268 195/229/268\n" +
            "f 194/230/269 190/172/269 129/107/269 196/54/269\n" +
            "f 189/186/270 191/224/270 193/228/270\n" +
            "f 194/230/271 192/225/271 190/172/271\n" +
            "f 199/96/272 187/95/272 179/148/272\n" +
            "f 194/226/273 196/231/273 186/53/273\n" +
            "f 171/212/274 169/232/274 201/168/274\n" +
            "f 200/52/275 188/191/275 186/53/275\n" +
            "f 172/214/276 174/223/276 178/85/276\n" +
            "f 192/221/277 194/226/277 188/191/277\n" +
            "f 197/89/278 181/185/278 183/195/278\n" +
            "f 128/178/279 195/229/279 159/197/279\n" +
            "f 185/94/280 193/227/280 187/95/280\n" +
            "f 199/96/281 181/185/281 197/89/281\n" +
            "f 173/196/282 183/195/282 175/184/282\n" +
            "f 169/232/283 167/169/283 201/168/283\n" +
            "f 175/184/284 167/169/284 169/200/284\n" +
            "f 179/148/285 181/185/285 199/96/285\n" +
            "f 202/187/286 170/219/286 172/217/286\n" +
            "f 177/90/287 159/197/287 195/91/287\n" +
            "f 166/189/288 192/221/288 180/93/288\n" +
            "f 176/218/289 168/190/289 182/92/289\n" +
            "f 130/233/290 203/171/290 136/199/290\n" +
            "f 198/51/291 184/222/291 182/92/291\n" +
            "f 173/196/292 171/216/292 177/90/292\n" +
            "f 176/218/293 174/223/293 170/234/293\n" +
            "f 170/234/294 174/223/294 172/214/294\n" +
            "f 137/235/295 166/189/295 204/188/295\n" +
            "f 3/7/296 1/6/296 9/35/296 5/8/296\n" +
            "f 137/235/297 135/220/297 166/189/297\n" +
            "f 160/215/298 131/236/298 204/188/298\n" +
            "f 204/188/299 131/236/299 137/235/299\n" +
            "f 16/12/300 164/101/300 158/44/300\n" +
            "f 8/9/301 2/4/301 10/3/301 6/2/301\n" +
            "f 155/179/302 157/10/302 15/43/302"

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)
        setSupportActionBar(toolbar)

        fab.setOnClickListener { view ->
            Snackbar.make(view, "Replace with your own action", Snackbar.LENGTH_LONG)
                    .setAction("Action", null).show()
        }
    }

    override fun notifyFinish() {
        Log.d("Task finished", "Task finished")
        finishedThreadsCounter += 1
        if(finishedThreadsCounter == threads) {
            finishedThreadsCounter = 0
            renderScreen.pushChanges(completeArray)
            passes += 1
            render()
            Log.d("Passes", "Pass finished")
        }
    }

    override fun onCreateOptionsMenu(menu: Menu): Boolean {
        // Inflate the menu; this adds items to the action bar if it is present.
        menuInflater.inflate(R.menu.menu_main, menu)
        return true
    }

    override fun onOptionsItemSelected(item: MenuItem): Boolean {
        // Handle action bar item clicks here. The action bar will
        // automatically handle clicks on the Home/Up button, so long
        // as you specify a parent activity in AndroidManifest.xml.
        return when (item.itemId) {
            R.id.action_settings -> true
            else -> super.onOptionsItemSelected(item)
        }
    }

    override fun onWindowFocusChanged(hasFocus: Boolean) {
        super.onWindowFocusChanged(hasFocus)

        renderScreen.viewTreeObserver.addOnGlobalLayoutListener {
            render()
        }
    }

    private fun render() {
        val heightSize = renderScreen.height / threads
        val triangles = ObjReader.parseObj(objTest)

        for(i in 0 until threads) {
            lateinit var frag : RenderFragment
            if(completeArray.size != threads) {
                frag = RenderFragment(0, renderScreen.width, heightSize * i, heightSize)
                completeArray.add(frag)
            } else {
                frag = completeArray[i]
            }


            val renderer = Renderer(Scene(*triangles, Sphere(Point3D(-9.0, -1.0, 2.0), 1.0, Col(255,255,255), true)), renderScreen.measuredWidth, renderScreen.height, 4)
            RenderAsyncTask(this, renderer).executeOnExecutor(AsyncTask.THREAD_POOL_EXECUTOR, frag)
        }
    }
}
